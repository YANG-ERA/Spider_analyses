Search.setIndex({"docnames": ["3D_simulation", "Benchmark_datasets_generation", "Installation", "Reference-based_simulation", "TIME_simulation", "index"], "filenames": ["3D_simulation.ipynb", "Benchmark_datasets_generation.ipynb", "Installation.rst", "Reference-based_simulation.ipynb", "TIME_simulation.ipynb", "index.rst"], "titles": ["3D ST dataset simulation", "Benchmark datasets generation", "Installation", "Reference-based Simulation", "Tumor immune microenvironments ST dataset simulation", "Welcome to Spider\u2019s documentation!"], "terms": {"we": [0, 1, 3, 4], "cell": [0, 1, 3, 4, 5], "posit": 0, "10": [0, 1, 3, 4], "region": 0, "divid": 0, "three": [0, 4], "guid": 0, "type": [0, 1, 3, 4, 5], "accord": 0, "differ": [0, 4], "ratio": 0, "transit": [0, 3, 4, 5], "matric": [0, 4], "1": [0, 1, 3, 4], "import": [0, 1, 3, 4], "spider": [0, 1, 2, 3, 4], "sp": [0, 1, 3, 4], "scanpi": [0, 1, 2, 3, 4], "sc": [0, 1, 3, 4], "numpi": [0, 1, 2, 3, 4], "np": [0, 1, 3, 4], "matplotlib": [0, 2, 3, 4], "pyplot": [0, 3, 4], "plt": [0, 3, 4], "itertool": [0, 3, 4], "anndata": [0, 1, 2, 3, 4], "ad": [0, 1, 3, 4], "2": [0, 1, 3, 4], "image_width": [0, 1, 4], "image_height": [0, 1, 4], "image_depth": 0, "cell_num": [0, 1, 4], "10000": [0, 1, 4], "num_celltyp": [0, 1, 3, 4], "4": [0, 1, 3, 4], "points_x": 0, "random": 0, "uniform": 0, "0": [0, 1, 3, 4], "points_i": 0, "points_z": 0, "cell_loc": [0, 1, 4], "vstack": 0, "t": [0, 1, 4], "3": [0, 1, 3, 4], "mixed_zone1": 0, "mixed_zone2": 0, "other_zon": 0, "zone1_loc": 0, "zone1_num": 0, "shape": [0, 1, 3], "5": [0, 1, 3, 4], "mix": 0, "prior": [0, 1, 4], "arrai": [0, 3, 4], "01": [0, 4], "33": [0, 3, 4], "num_ct_sampl": [0, 1, 3, 4], "get_ct_sampl": [0, 4], "num_sampl": [0, 1, 4], "target_tran": [0, 1, 4], "stripe_freq": [0, 4], "45": [0, 4], "05": [0, 4], "6": [0, 1, 3], "res_1": 0, "_": 0, "simulate_10x_3d": 0, "tol": [0, 1, 4], "2e": [0, 1, 4], "1e": [0, 1, 4], "loop_tim": [0, 1, 4], "none": [0, 1, 4], "smallsample_max_it": [0, 1, 4], "100000": [0, 1, 4], "bigsample_max_it": [0, 1, 4], "swap_num": [0, 1, 4], "refin": [0, 1, 4], "metropoli": [0, 1, 4], "hast": [0, 1, 4], "algorithm": [0, 1, 4, 5], "sampl": [0, 1, 4], "num": [0, 1, 4], "617": 0, "iter": [0, 1, 4], "error": [0, 1, 4], "767": 0, "20000": [0, 1, 4], "793": [0, 4], "30000": [0, 1, 4], "782": 0, "40000": [0, 1, 4], "784": 0, "50000": [0, 1, 4], "766": 0, "60000": [0, 1, 4], "755": 0, "70000": [0, 1, 4], "783": 0, "80000": [0, 1, 4], "90000": [0, 1, 4], "776": 0, "7": [0, 1, 3], "zone2_loc": 0, "zone2_num": 0, "8": [0, 1, 3, 4], "9": [0, 1, 3, 4], "res_2": 0, "598": 0, "802": 0, "794": [0, 4], "803": 0, "796": [0, 4], "799": 0, "zone3_loc": 0, "zone3_num": 0, "11": [0, 1], "94": 0, "02": [0, 4], "addictive_freq": [0, 1, 4], "repeat": [0, 4], "25": [0, 1, 4], "06666667": [0, 4], "12": [0, 1], "res_3": 0, "8785": 0, "038": 0, "036": [0, 1], "035": 0, "037": 0, "13": [0, 1, 4], "5133301": 0, "3451748": 0, "92689996": 0, "09320824": 0, "25485754": 0, "72664263": 0, "68836415": 0, "33030128": 0, "20549689": 0, "18473939": 0, "34316272": 0, "21401793": 0, "94701773": 0, "89963518": 0, "39188892": 0, "23298101": 0, "31052682": 0, "65738106": 0, "14": [0, 1, 3, 4], "celltype_assign": [0, 1, 3], "zero": [0, 4], "dtype": 0, "int": [0, 1], "15": [0, 1, 3, 4], "ref_path": [0, 1, 3], "benchmark_dataset": [0, 1, 3], "ref_adata": [0, 1, 3], "read": [0, 1, 3], "use_ref": [0, 1, 3], "h5ad": [0, 1, 3], "ref_ct": [0, 1], "ob": [0, 1, 3, 4], "celltyp": [0, 1, 3], "value_count": [0, 1], "nlargest": [0, 1], "index": [0, 1, 3], "tolist": [0, 1, 3], "match_list": [0, 1, 3], "dict": [0, 1, 3], "zip": [0, 1, 3], "rang": [0, 1, 3], "16": [0, 1, 3, 4], "spider_adata": [0, 1, 3, 4], "get_sim_cell_level_expr": [0, 1, 3], "adata": [0, 1, 3], "bincount": [0, 1, 3], "ct_kei": [0, 1, 3], "17": [0, 1, 3, 4], "obsm": [0, 1, 3, 4], "str": [0, 1, 3], "j": [0, 1, 3], "18": [0, 1, 3], "object": [0, 1], "n_ob": [0, 1], "n_var": [0, 1], "882": [0, 1], "39": [0, 1], "label": [0, 1, 3, 5], "var": [0, 1], "un": [0, 1], "svg_scanpi": [0, 1], "svg_squidpi": [0, 1], "19": [0, 1, 3, 4], "fig1": 0, "plot_3d_cell_typ": 0, "interact": 0, "true": [0, 3], "save_path": [0, 1, 3], "3d_cell_types_0710": 0, "html": 0, "auto_open": 0, "23": [0, 1], "z_bin": 0, "arang": 0, "24": [0, 1, 3], "slice": 0, "slice_anndata_by_z": 0, "z_kei": 0, "creat": [0, 4], "z": 0, "1994": 0, "1996": 0, "2039": 0, "1991": 0, "1980": 0, "assum": 0, "i": [0, 2, 5], "your": 0, "list": 0, "from": [0, 3, 4, 5], "fig2": 0, "plot_z_slic": 0, "output_path": 0, "z_slices_visualization_0710": 0, "pdf": 0, "figsize_per_slic": 0, "dpi": 0, "300": 0, "In": [1, 3, 4], "thi": [1, 3, 4], "tutori": [1, 3, 4], "emploi": [1, 3], "spatial": [1, 3, 4, 5], "resolv": 1, "transcriptom": [1, 3], "simul": 1, "distinct": [1, 3], "biolog": 1, "includ": 1, "attract": 1, "repuls": 1, "like": 1, "distribut": 1, "panda": [1, 2], "pd": 1, "set_figure_param": [1, 3, 4], "color_map": [1, 3, 4], "viridi": [1, 3, 4], "figsiz": [1, 3, 4], "2500": [1, 4], "ones": 1, "re": [1, 4], "simulate_10x": [1, 4], "spot_radiu": [1, 4], "spot_min": [1, 4], "spot_max": [1, 4], "150000": [1, 4], "us": [1, 2, 4, 5], "789": [1, 4], "505": 1, "340": 1, "257": 1, "185": 1, "145": 1, "109": 1, "091": 1, "073": 1, "054": 1, "110000": [1, 4], "046": 1, "120000": [1, 4], "130000": [1, 4], "029": 1, "write_h5ad": [1, 3], "spider_simu_addictive_cell_level": 1, "x": [1, 3, 4], "y": [1, 3, 4], "pl": [1, 3, 4], "scatter": [1, 3, 4], "color": [1, 3, 4], "spot_data": 1, "generate_spot_level_data": 1, "spider_simu_addictive_spot_level": 1, "spot_diamet": 1, "gap": 1, "spot_generate_typ": 1, "squar": 1, "400": 1, "gene": [1, 3, 5], "w": 1, "exclusive_freq": 1, "447": 1, "260": 1, "175": 1, "144": 1, "116": 1, "095": 1, "079": 1, "069": 1, "064": 1, "058": 1, "049": 1, "043": 1, "140000": [1, 4], "042": 1, "spider_simu_exclusive_cell_level": 1, "20": [1, 4], "spider_simu_exclusive_spot_level": 1, "21": [1, 3], "399": 1, "22": 1, "scenario": 1, "80": [1, 4], "04": 1, "sim_sc_loc": 1, "layer_cell_level_sim": 1, "scenarios_mod": 1, "row": 1, "layer_label": 1, "ct_label_init": 1, "astyp": [1, 4], "spider_simu_layer_cell_level": 1, "26": [1, 4], "27": [1, 3, 4], "size": 1, "100": [1, 3], "28": [1, 4], "spider_simu_layer_spot_level": 1, "50": 1, "29": [1, 4], "384": 1, "30": [1, 3], "31": 4, "def": [], "muti_circl": 1, "col": [], "int32": [], "n_spot": [], "layer_width_a": [], "round": [], "layer_width_b": [], "b": [], "meshgrid": [], "ij": [], "reshap": [], "layer_index": [], "intersect1d": [], "where": [], "return": [], "32": 4, "muti_squar": [], "bound_a": [], "bound_b": [], "layer_index1": [], "layer_index2": [], "layer_index3": [], "naive_cell_level_sim": 1, "method": 1, "spatialpca": [], "full_sampl": [], "equal": [], "num_lay": [], "sc_loc": [], "rand_index": [], "choic": [], "replac": [], "fals": [], "sc_layer_idx": [], "argmax": [], "multinomi": [], "n": [], "pval": [], "move_list": [], "k": [], "len": [3, 4], "\u591a\u9879\u5206\u5e03": [], "34": [1, 3, 4], "sim_sc_loc_circl": 1, "35": [1, 3, 4], "spider_simu_gyrus_cell_level": 1, "36": [1, 4], "37": 1, "38": 1, "spider_simu_gyrus_spot_level": 1, "383": 1, "perform": 3, "which": 3, "infer": 3, "both": 3, "matrix": [3, 5], "proport": [3, 4], "directli": 3, "dataset": [3, 5], "For": 3, "our": 3, "data": [3, 4], "singl": 3, "resolut": 3, "mous": 3, "visual": 3, "cortex": 3, "avail": 3, "http": 3, "www": 3, "starmapresourc": 3, "com": 3, "comprehens": 3, "captur": 3, "549": 3, "repres": 3, "were": 3, "rigor": 3, "identifi": 3, "through": [3, 5], "cluster": 3, "analysi": 3, "carefulli": 3, "curat": 3, "marker": 3, "choos": 3, "cell_level": 3, "real_celltyp": 3, "uniqu": 3, "grid_row": 3, "grid_col": 3, "perturb": 3, "seed": 3, "2025": 3, "parallel": 3, "n_job": 3, "backend": 3, "lokybackend": 3, "concurr": 3, "worker": 3, "user": [3, 5], "era": 3, "anaconda3": 3, "env": 3, "lib": 3, "python3": 3, "site": 3, "packag": [2, 3], "networkx": 3, "util": [3, 4], "py": 3, "135": 3, "runtimewarn": 3, "defin": 3, "more": 3, "than": 3, "onc": 3, "nx": 3, "loopback": 3, "updat": 3, "_get_backend": 3, "done": 3, "task": 3, "elaps": 3, "42": 3, "53": 3, "64": 3, "77": 3, "90": 3, "out": 3, "finish": 3, "spider_simu": 3, "spider_perturb_simu_cell_level": 3, "showcas": 4, "applic": 4, "gener": [4, 5], "time": 4, "previou": 4, "studi": 4, "have": 4, "shown": 4, "secret": 4, "variou": 4, "cytokin": 4, "chemokin": 4, "local": 4, "recruit": 4, "amount": 4, "The": 4, "organ": 4, "phenotyp": 4, "can": [4, 5], "classifi": 4, "categori": 4, "exhibit": 4, "few": 4, "infiltr": 4, "mainli": [2, 4], "macrophag": 4, "contrast": 4, "numer": 4, "intermix": 4, "high": 4, "ar": 4, "segreg": 4, "set": 4, "appropri": 4, "97": 4, "325": 4, "326": 4, "332": 4, "312": 4, "319": 4, "306": 4, "309": 4, "cell_typ": 4, "804": 4, "785": 4, "771": 4, "792": 4, "795": 4, "786": 4, "03": 4, "696": 4, "552": 4, "514": 4, "462": 4, "476": 4, "474": 4, "467": 4, "465": 4, "468": 4, "472": 4, "475": 4, "refer": 5, "base": [2, 5], "benchmark": 5, "tumor": 5, "immun": 5, "microenviron": 5, "3d": 5, "leverag": 5, "neighborhood": 5, "pattern": 5, "among": 5, "condit": 5, "optim": 5, "By": 5, "input": 5, "extract": 5, "real": 5, "specifi": 5, "assign": 5, "bsa": 5, "improv": 5, "comput": 5, "effici": 5, "convent": 5, "anneal": 5, "express": 5, "profil": 5, "individu": 5, "either": 5, "splatter": 5, "scdesign2": 5, "final": 5, "spot": 5, "level": 5, "aggreg": 5, "insid": 5, "10x": 5, "encod": 5, "scheme": 5, "rule": 5, "python": 2, "post1": [], "numba": 2, "59": [], "scikit": 2, "learn": 2, "scipi": 2, "seaborn": 2, "squidpi": 2, "torch": [], "via": 2, "pypi": 2, "pip": 2, "st": 2, "instal": 5, "plotli": 2, "joblib": 2}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"3d": 0, "st": [0, 4, 5], "dataset": [0, 1, 4], "simul": [0, 3, 4, 5], "gener": [0, 1], "gene": 0, "express": 0, "profil": 0, "us": [0, 3], "refer": [0, 3], "visiual": 0, "spatial": 0, "distribut": 0, "benchmark": 1, "addict": 1, "pattern": 1, "exclus": 1, "layer": 1, "gyru": 1, "base": 3, "psa": 3, "function": 3, "tumor": 4, "immun": 4, "microenviron": 4, "cold": 4, "mix": 4, "compartment": 4, "welcom": 5, "spider": 5, "": 5, "document": 5, "flexibl": 5, "unifi": 5, "framework": 5, "data": 5, "content": 5, "overview": 5, "instal": 2, "softwar": 2, "depend": 2}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "nbsphinx": 4, "sphinx": 60}, "alltitles": {"3D ST dataset simulation": [[0, "3D-ST-dataset-simulation"]], "generated gene expression profiles using reference dataset": [[0, "generated-gene-expression-profiles-using-reference-dataset"]], "Visiualization of spatial distribution": [[0, "Visiualization-of-spatial-distribution"]], "Reference-based Simulation": [[3, "Reference-based-Simulation"]], "Simulation using PSA function": [[3, "Simulation-using-PSA-function"]], "Welcome to Spider\u2019s documentation!": [[5, "welcome-to-spider-s-documentation"]], "Spider \u2013 a flexible and unified framework for simulating ST data.": [[5, "spider-a-flexible-and-unified-framework-for-simulating-st-data"]], "Contents:": [[5, null]], "Overview": [[5, "overview"]], "Installation": [[2, "installation"], [2, "id1"]], "Software dependencies": [[2, "software-dependencies"]], "Benchmark datasets generation": [[1, "Benchmark-datasets-generation"]], "Addictive pattern": [[1, "Addictive-pattern"]], "Exclusive pattern": [[1, "Exclusive-pattern"]], "Layer pattern": [[1, "Layer-pattern"]], "Gyrus pattern": [[1, "Gyrus-pattern"]], "Tumor immune microenvironments ST dataset simulation": [[4, "Tumor-immune-microenvironments-ST-dataset-simulation"]], "Cold": [[4, "Cold"]], "Mixed": [[4, "Mixed"]], "Compartmentalized": [[4, "Compartmentalized"]]}, "indexentries": {}})
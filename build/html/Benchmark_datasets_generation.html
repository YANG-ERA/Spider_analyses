<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Benchmark datasets generation &mdash; Spider v1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=92fd9be5" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/nbsphinx-code-cells.css?v=2aa19091" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=5cb08e4e"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tumor immune microenvironments ST dataset simulation" href="TIME_simulation.html" />
    <link rel="prev" title="Reference-based Simulation" href="Reference-based_simulation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Spider
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Reference-based_simulation.html">Reference-based Simulation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Benchmark datasets generation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Addictive-pattern">Addictive pattern</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Exclusive-pattern">Exclusive pattern</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Layer-pattern">Layer pattern</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Gyrus-pattern">Gyrus pattern</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="TIME_simulation.html">Tumor immune microenvironments ST dataset simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="3D_simulation.html">3D ST dataset simulation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Spider</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Benchmark datasets generation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/Benchmark_datasets_generation.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Benchmark-datasets-generation">
<h1>Benchmark datasets generation<a class="headerlink" href="#Benchmark-datasets-generation" title="Link to this heading"></a></h1>
<p>In this tutorial, we employed Spider to generate spatially resolved transcriptomic datasets simulating distinct biological patterns, including attractive, repulsive, layered, and gyrus-like spatial distributions.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">spider</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">scanpy</span> <span class="k">as</span> <span class="nn">sc</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">anndata</span> <span class="k">as</span> <span class="nn">ad</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span><span class="o">.</span><span class="n">set_figure_params</span><span class="p">(</span> <span class="n">color_map</span> <span class="o">=</span> <span class="s1">&#39;viridis&#39;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Num_celltype</span> <span class="o">=</span><span class="mi">6</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Num_sample</span> <span class="o">=</span> <span class="mi">2500</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prior</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">Num_celltype</span><span class="p">)</span><span class="o">/</span><span class="n">Num_celltype</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">save_path</span> <span class="o">=</span> <span class="s2">&quot;./simulations&quot;</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ref_path</span> <span class="o">=</span> <span class="s2">&quot;./Benchmark_datasets/&quot;</span>
<span class="n">ref_adata</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">ref_path</span> <span class="o">+</span> <span class="s2">&quot;use_ref.h5ad&quot;</span><span class="p">)</span>
<span class="n">ref_ct</span> <span class="o">=</span> <span class="n">ref_adata</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">celltype</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">match_list</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">Num_celltype</span><span class="p">),</span><span class="n">ref_ct</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<section id="Addictive-pattern">
<h2>Addictive pattern<a class="headerlink" href="#Addictive-pattern" title="Link to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">target_trans</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">addictive_freq</span><span class="p">(</span><span class="n">Num_celltype</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span><span class="p">,</span> <span class="n">cell_location</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">simulate_10X</span><span class="p">(</span><span class="n">cell_num</span><span class="o">=</span><span class="n">Num_sample</span><span class="p">,</span>
                                  <span class="n">Num_celltype</span><span class="o">=</span><span class="n">Num_celltype</span><span class="p">,</span>
                                  <span class="n">prior</span><span class="o">=</span><span class="n">prior</span><span class="p">,</span>
                                  <span class="n">target_trans</span><span class="o">=</span><span class="n">target_trans</span><span class="p">,</span>
                                  <span class="n">spot_radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                  <span class="n">spot_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                  <span class="n">spot_max</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                  <span class="n">image_width</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                  <span class="n">image_height</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                  <span class="n">cell_location</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                  <span class="n">tol</span><span class="o">=</span><span class="mf">2e-2</span><span class="p">,</span>
                                  <span class="n">T</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span>
                                  <span class="n">loop_times</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                  <span class="n">smallsample_max_iter</span><span class="o">=</span><span class="mi">150000</span><span class="p">,</span>
                                  <span class="n">bigsample_max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
swap_num:  1
Refine cell type using Metropolis–Hastings algorithm.
Sample num:2500
10000 iteration, error 0.789
20000 iteration, error 0.505
30000 iteration, error 0.340
40000 iteration, error 0.257
50000 iteration, error 0.185
60000 iteration, error 0.145
70000 iteration, error 0.109
80000 iteration, error 0.091
90000 iteration, error 0.073
100000 iteration, error 0.054
110000 iteration, error 0.046
120000 iteration, error 0.036
130000 iteration, error 0.029
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><br/><br/><span></span><span class="n">spider_adata</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">get_sim_cell_level_expr</span><span class="p">(</span><span class="n">celltype_assignment</span><span class="o">=</span><span class="n">res</span><span class="p">,</span>
                                   <span class="n">adata</span><span class="o">=</span><span class="n">ref_adata</span><span class="p">,</span>
                                   <span class="n">Num_celltype</span><span class="o">=</span><span class="n">Num_celltype</span><span class="p">,</span>
                                   <span class="n">Num_ct_sample</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">res</span><span class="p">),</span>
                                   <span class="n">match_list</span><span class="o">=</span><span class="n">match_list</span><span class="p">,</span>
                                   <span class="n">ct_key</span><span class="o">=</span><span class="s2">&quot;celltype&quot;</span><span class="p">)</span>

<span class="n">spider_adata</span><span class="o">.</span><span class="n">obsm</span><span class="p">[</span><span class="s2">&quot;spatial&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cell_location</span>
<span class="n">spider_adata</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;cell&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">spider_adata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="p">]</span>
<span class="n">spider_adata</span><span class="o">.</span><span class="n">write_h5ad</span><span class="p">(</span><span class="n">save_path</span> <span class="o">+</span> <span class="s2">&quot;/spider_simu_addictive_cell_level.h5ad&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spider_adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">spider_adata</span><span class="o">.</span><span class="n">obsm</span><span class="p">[</span><span class="s2">&quot;spatial&quot;</span><span class="p">][:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">spider_adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">spider_adata</span><span class="o">.</span><span class="n">obsm</span><span class="p">[</span><span class="s2">&quot;spatial&quot;</span><span class="p">][:,</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">spider_adata</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;celltype&quot;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Benchmark_datasets_generation_15_0.png" class="no-scaled-link" src="_images/Benchmark_datasets_generation_15_0.png" style="width: 515px; height: 379px;" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spot_data</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">generate_spot_level_data</span><span class="p">(</span>
    <span class="n">spider_adata</span><span class="o">=</span><span class="n">spider_adata</span><span class="p">,</span>
    <span class="n">save_path</span><span class="o">=</span><span class="n">save_path</span> <span class="o">+</span> <span class="s2">&quot;/spider_simu_addictive_spot_level.h5ad&quot;</span><span class="p">,</span>
    <span class="n">spot_diameter</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">gap</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">spot_generate_type</span><span class="o">=</span><span class="s2">&quot;square&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spot_data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
AnnData object with n_obs × n_vars = 400 × 882
    var: &#39;gene&#39;
    uns: &#39;W&#39;
    obsm: &#39;spatial&#39;
</pre></div></div>
</div>
</section>
<section id="Exclusive-pattern">
<h2>Exclusive pattern<a class="headerlink" href="#Exclusive-pattern" title="Link to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">target_trans</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">exclusive_freq</span><span class="p">(</span><span class="n">Num_celltype</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span><span class="p">,</span> <span class="n">cell_location</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">simulate_10X</span><span class="p">(</span><span class="n">cell_num</span><span class="o">=</span><span class="n">Num_sample</span><span class="p">,</span>
                                  <span class="n">Num_celltype</span><span class="o">=</span><span class="n">Num_celltype</span><span class="p">,</span>
                                  <span class="n">prior</span><span class="o">=</span><span class="n">prior</span><span class="p">,</span>
                                  <span class="n">target_trans</span><span class="o">=</span><span class="n">target_trans</span><span class="p">,</span>
                                  <span class="n">spot_radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                  <span class="n">spot_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                  <span class="n">spot_max</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                  <span class="n">image_width</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                  <span class="n">image_height</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                  <span class="n">cell_location</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                  <span class="n">tol</span><span class="o">=</span><span class="mf">2e-2</span><span class="p">,</span>
                                  <span class="n">T</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span>
                                  <span class="n">loop_times</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                  <span class="n">smallsample_max_iter</span><span class="o">=</span><span class="mi">150000</span><span class="p">,</span>
                                  <span class="n">bigsample_max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
swap_num:  1
Refine cell type using Metropolis–Hastings algorithm.
Sample num:2500
10000 iteration, error 0.447
20000 iteration, error 0.260
30000 iteration, error 0.175
40000 iteration, error 0.144
50000 iteration, error 0.116
60000 iteration, error 0.095
70000 iteration, error 0.079
80000 iteration, error 0.069
90000 iteration, error 0.064
100000 iteration, error 0.058
110000 iteration, error 0.049
120000 iteration, error 0.046
130000 iteration, error 0.043
140000 iteration, error 0.043
150000 iteration, error 0.042
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><br/><br/><span></span><span class="n">spider_adata</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">get_sim_cell_level_expr</span><span class="p">(</span><span class="n">celltype_assignment</span><span class="o">=</span><span class="n">res</span><span class="p">,</span>
                                   <span class="n">adata</span><span class="o">=</span><span class="n">ref_adata</span><span class="p">,</span>
                                   <span class="n">Num_celltype</span><span class="o">=</span><span class="n">Num_celltype</span><span class="p">,</span>
                                   <span class="n">Num_ct_sample</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">res</span><span class="p">),</span>
                                   <span class="n">match_list</span><span class="o">=</span><span class="n">match_list</span><span class="p">,</span>
                                   <span class="n">ct_key</span><span class="o">=</span><span class="s2">&quot;celltype&quot;</span><span class="p">)</span>

<span class="n">spider_adata</span><span class="o">.</span><span class="n">obsm</span><span class="p">[</span><span class="s2">&quot;spatial&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cell_location</span>
<span class="n">spider_adata</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;cell&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">spider_adata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="p">]</span>
<span class="n">spider_adata</span><span class="o">.</span><span class="n">write_h5ad</span><span class="p">(</span><span class="n">save_path</span> <span class="o">+</span> <span class="s2">&quot;/spider_simu_exclusive_cell_level.h5ad&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spider_adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">spider_adata</span><span class="o">.</span><span class="n">obsm</span><span class="p">[</span><span class="s2">&quot;spatial&quot;</span><span class="p">][:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">spider_adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">spider_adata</span><span class="o">.</span><span class="n">obsm</span><span class="p">[</span><span class="s2">&quot;spatial&quot;</span><span class="p">][:,</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">spider_adata</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;celltype&quot;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Benchmark_datasets_generation_23_0.png" class="no-scaled-link" src="_images/Benchmark_datasets_generation_23_0.png" style="width: 515px; height: 379px;" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spot_data</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">generate_spot_level_data</span><span class="p">(</span>
    <span class="n">spider_adata</span><span class="o">=</span><span class="n">spider_adata</span><span class="p">,</span>
    <span class="n">save_path</span><span class="o">=</span><span class="n">save_path</span> <span class="o">+</span> <span class="s2">&quot;/spider_simu_exclusive_spot_level.h5ad&quot;</span><span class="p">,</span>
    <span class="n">spot_diameter</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">gap</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">spot_generate_type</span><span class="o">=</span><span class="s2">&quot;square&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spot_data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
AnnData object with n_obs × n_vars = 399 × 882
    var: &#39;gene&#39;
    uns: &#39;W&#39;
    obsm: &#39;spatial&#39;
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
<section id="Layer-pattern">
<h2>Layer pattern<a class="headerlink" href="#Layer-pattern" title="Link to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scenarios</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.80</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim_sc_loc</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">layer_cell_level_sim</span><span class="p">(</span><span class="n">Num_sample</span><span class="o">=</span><span class="mi">2500</span><span class="p">,</span>
                            <span class="n">Num_celltype</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
                            <span class="n">image_width</span><span class="o">=</span><span class="mi">400</span><span class="o">*</span><span class="mi">6</span><span class="p">,</span>
                            <span class="n">image_height</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span>
                            <span class="n">scenarios_mode</span><span class="o">=</span><span class="n">scenarios</span><span class="p">)</span> <span class="c1"># rows:x,y,layer_label,ct_label_init</span>
<span class="n">spider_adata</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">get_sim_cell_level_expr</span><span class="p">(</span><span class="n">celltype_assignment</span><span class="o">=</span><span class="n">sim_sc_loc</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">),</span>
                                   <span class="n">adata</span><span class="o">=</span><span class="n">ref_adata</span><span class="p">,</span>
                                   <span class="n">Num_celltype</span><span class="o">=</span><span class="n">Num_celltype</span><span class="p">,</span>
                                   <span class="n">Num_ct_sample</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">sim_sc_loc</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">)),</span>
                                   <span class="n">match_list</span><span class="o">=</span><span class="n">match_list</span><span class="p">,</span>
                                   <span class="n">ct_key</span><span class="o">=</span><span class="s2">&quot;celltype&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spider_adata</span><span class="o">.</span><span class="n">obsm</span><span class="p">[</span><span class="s2">&quot;spatial&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sim_sc_loc</span><span class="p">[:,:</span><span class="mi">2</span><span class="p">]</span>
<span class="n">spider_adata</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;cell&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">spider_adata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="p">]</span>
<span class="n">spider_adata</span><span class="o">.</span><span class="n">write_h5ad</span><span class="p">(</span><span class="n">save_path</span> <span class="o">+</span> <span class="s2">&quot;/spider_simu_layer_cell_level.h5ad&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spider_adata</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
AnnData object with n_obs × n_vars = 2500 × 882
    obs: &#39;celltype&#39;, &#39;label&#39;
    var: &#39;gene&#39;
    uns: &#39;svg_scanpy&#39;, &#39;svg_squidpy&#39;
    obsm: &#39;spatial&#39;
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spider_adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">spider_adata</span><span class="o">.</span><span class="n">obsm</span><span class="p">[</span><span class="s2">&quot;spatial&quot;</span><span class="p">][:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">spider_adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">spider_adata</span><span class="o">.</span><span class="n">obsm</span><span class="p">[</span><span class="s2">&quot;spatial&quot;</span><span class="p">][:,</span><span class="mi">1</span><span class="p">]</span>
<br/></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">spider_adata</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;celltype&quot;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Benchmark_datasets_generation_33_0.png" class="no-scaled-link" src="_images/Benchmark_datasets_generation_33_0.png" style="width: 523px; height: 379px;" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spot_data</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">generate_spot_level_data</span><span class="p">(</span>
    <span class="n">spider_adata</span><span class="o">=</span><span class="n">spider_adata</span><span class="p">,</span>
    <span class="n">save_path</span><span class="o">=</span><span class="n">save_path</span> <span class="o">+</span> <span class="s2">&quot;/spider_simu_layer_spot_level.h5ad&quot;</span><span class="p">,</span>
    <span class="n">spot_diameter</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">gap</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">spot_generate_type</span><span class="o">=</span><span class="s2">&quot;square&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spot_data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
AnnData object with n_obs × n_vars = 384 × 882
    var: &#39;gene&#39;
    uns: &#39;W&#39;
    obsm: &#39;spatial&#39;
</pre></div></div>
</div>
</section>
<section id="Gyrus-pattern">
<h2>Gyrus pattern<a class="headerlink" href="#Gyrus-pattern" title="Link to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scenarios</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.80</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#muti_circle</span>
<span class="n">sim_sc_loc_circle</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">naive_cell_level_sim</span><span class="p">(</span><span class="n">Num_sample</span><span class="o">=</span><span class="mi">2500</span><span class="p">,</span>
                            <span class="n">Num_celltype</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
                            <span class="n">image_width</span><span class="o">=</span><span class="mi">400</span><span class="o">*</span><span class="mi">6</span><span class="p">,</span>
                            <span class="n">image_height</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span>
                            <span class="n">scenarios_mode</span><span class="o">=</span><span class="n">scenarios</span><span class="p">,</span>
                            <span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;muti_circle&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><br/><span></span><span class="n">spider_adata</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">get_sim_cell_level_expr</span><span class="p">(</span><span class="n">celltype_assignment</span><span class="o">=</span><span class="n">sim_sc_loc_circle</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">),</span>
                                   <span class="n">adata</span><span class="o">=</span><span class="n">ref_adata</span><span class="p">,</span>
                                   <span class="n">Num_celltype</span><span class="o">=</span><span class="n">Num_celltype</span><span class="p">,</span>
                                   <span class="n">Num_ct_sample</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">sim_sc_loc_circle</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">)),</span>
                                   <span class="n">match_list</span><span class="o">=</span><span class="n">match_list</span><span class="p">,</span>
                                   <span class="n">ct_key</span><span class="o">=</span><span class="s2">&quot;celltype&quot;</span><span class="p">)</span>

<span class="n">spider_adata</span><span class="o">.</span><span class="n">obsm</span><span class="p">[</span><span class="s2">&quot;spatial&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sim_sc_loc_circle</span><span class="p">[:,:</span><span class="mi">2</span><span class="p">]</span>
<span class="n">spider_adata</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;cell&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">spider_adata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="p">]</span>
<span class="n">spider_adata</span><span class="o">.</span><span class="n">write_h5ad</span><span class="p">(</span><span class="n">save_path</span> <span class="o">+</span> <span class="s2">&quot;spider_simu_gyrus_cell_level.h5ad&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spider_adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">spider_adata</span><span class="o">.</span><span class="n">obsm</span><span class="p">[</span><span class="s2">&quot;spatial&quot;</span><span class="p">][:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">spider_adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">spider_adata</span><span class="o">.</span><span class="n">obsm</span><span class="p">[</span><span class="s2">&quot;spatial&quot;</span><span class="p">][:,</span><span class="mi">1</span><span class="p">]</span>
<br/></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">spider_adata</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;celltype&quot;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Benchmark_datasets_generation_41_0.png" class="no-scaled-link" src="_images/Benchmark_datasets_generation_41_0.png" style="width: 523px; height: 379px;" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spot_data</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">generate_spot_level_data</span><span class="p">(</span>
    <span class="n">spider_adata</span><span class="o">=</span><span class="n">spider_adata</span><span class="p">,</span>
    <span class="n">save_path</span><span class="o">=</span><span class="n">save_path</span> <span class="o">+</span> <span class="s2">&quot;/spider_simu_gyrus_spot_level.h5ad&quot;</span><span class="p">,</span>
    <span class="n">spot_diameter</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">gap</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">spot_generate_type</span><span class="o">=</span><span class="s2">&quot;square&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spot_data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
AnnData object with n_obs × n_vars = 383 × 882
    var: &#39;gene&#39;
    uns: &#39;W&#39;
    obsm: &#39;spatial&#39;
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Reference-based_simulation.html" class="btn btn-neutral float-left" title="Reference-based Simulation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="TIME_simulation.html" class="btn btn-neutral float-right" title="Tumor immune microenvironments ST dataset simulation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Jiyuan Yang.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>